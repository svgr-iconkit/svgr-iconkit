{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import{useEffect}from'react';import{useFocusWithin}from'@react-aria/interactions';var visibleOverlays=[];export function useOverlay(props,ref){var onClose=props.onClose,shouldCloseOnBlur=props.shouldCloseOnBlur,isOpen=props.isOpen,_props$isKeyboardDism=props.isKeyboardDismissDisabled,isKeyboardDismissDisabled=_props$isKeyboardDism===void 0?false:_props$isKeyboardDism;useEffect(function(){if(isOpen){visibleOverlays.push(ref);}return function(){var index=visibleOverlays.indexOf(ref);if(index>=0){visibleOverlays.splice(index,1);}};},[isOpen,ref]);var onHide=function onHide(){if(visibleOverlays[visibleOverlays.length-1]===ref&&onClose){onClose();}};var onKeyDown=function onKeyDown(e){if(e.key==='Escape'&&!isKeyboardDismissDisabled){e.preventDefault();onHide();}};var _useFocusWithin=useFocusWithin({isDisabled:!shouldCloseOnBlur,onBlurWithin:function onBlurWithin(){onClose&&onClose();}}),focusWithinProps=_useFocusWithin.focusWithinProps;return{overlayProps:_objectSpread({onKeyDown:onKeyDown},focusWithinProps)};}","map":{"version":3,"sources":["useOverlay.web.ts"],"names":["visibleOverlays","isKeyboardDismissDisabled","useEffect","index","onHide","onClose","onKeyDown","e","focusWithinProps","useFocusWithin","isDisabled","onBlurWithin","overlayProps"],"mappings":"+1BAAA,OAAA,SAAA,KAAA,OAAA,CACA,OAAA,cAAA,KAAA,0BAAA,CAsCA,GAAMA,CAAAA,eAAyC,CAA/C,EAAA,CAOA,MAAO,SAAA,CAAA,UAAA,CAAA,KAAA,CAAA,GAAA,CAGQ,CACb,GAAI,CAAA,OAAJ,CADa,KACb,CAAI,OAAJ,CAAI,iBAAJ,CADa,KACb,CAAI,iBAAJ,CAAI,MAAJ,CADa,KACb,CAAI,MAAJ,uBADa,KACb,CAIEC,yBAJF,CAIEA,yBAJF,gCAI8B,KAJ9B,uBAQAC,SAAS,CAAC,UAAM,CACd,GAAA,MAAA,CAAY,CACVF,eAAe,CAAfA,IAAAA,CAAAA,GAAAA,EACD,CAED,MAAO,WAAM,CACX,GAAIG,CAAAA,KAAK,CAAGH,eAAe,CAAfA,OAAAA,CAAZ,GAAYA,CAAZ,CACA,GAAIG,KAAK,EAAT,CAAA,CAAgB,CACdH,eAAe,CAAfA,MAAAA,CAAAA,KAAAA,CAAAA,CAAAA,EACD,CAJH,CAAA,CALO,CAAA,CAWN,CAAA,MAAA,CApBU,GAoBV,CAXM,CAATE,CAcA,GAAIE,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CACjB,GAAIJ,eAAe,CAACA,eAAe,CAAfA,MAAAA,CAAhBA,CAAe,CAAfA,GAAAA,GAAAA,EAAJ,OAAA,CAAoE,CAClEK,OAAO,GACR,CA1BU,CAuBb,CAOA,GAAIC,CAAAA,SAAS,CAAIC,QAAbD,CAAAA,SAAaC,CAAAA,CAAD,CAAY,CAC1B,GAAIA,CAAC,CAADA,GAAAA,GAAAA,QAAAA,EAAsB,CAA1B,yBAAA,CAAsD,CACpDA,CAAC,CAADA,cAAAA,GACAH,MAAM,GACP,CAlCU,CA8Bb,CASA,oBAA2BK,cAAc,CAAC,CACxCC,UAAU,CAAE,CAD4B,iBAAA,CAExCC,YAAY,CAAE,uBAAM,CAClBN,OAAO,EAAIA,OAAXA,EAAAA,CACD,CAJuC,CAAD,CAAzC,CAAMG,gBAAN,iBAAMA,gBAAN,CAOA,MAAO,CACLI,YAAY,gBACVN,SADY,CACZA,SADU,EAEPE,gBAFO,CADP,CAAP,CAMD","sourcesContent":["import { HTMLAttributes, RefObject, useEffect } from 'react';\nimport { useFocusWithin } from '@react-aria/interactions';\n\ninterface OverlayProps {\n  /** Whether the overlay is currently open. */\n  isOpen?: boolean;\n\n  /** Handler that is called when the overlay should close. */\n  onClose?: () => void;\n\n  /**\n   * Whether to close the overlay when the user interacts outside it.\n   * @default false\n   */\n  isDismissable?: boolean;\n\n  /** Whether the overlay should close when focus is lost or moves outside it. */\n  shouldCloseOnBlur?: boolean;\n\n  /**\n   * Whether pressing the escape key to close the overlay should be disabled.\n   * @default false\n   */\n  isKeyboardDismissDisabled?: boolean;\n\n  /**\n   * When user interacts with the argument element outside of the overlay ref,\n   * return true if onClose should be called.  This gives you a chance to filter\n   * out interaction with elements that should not dismiss the overlay.\n   * By default, onClose will always be called on interaction outside the overlay ref.\n   */\n  shouldCloseOnInteractOutside?: (element: HTMLElement) => boolean;\n}\n\ninterface OverlayAria {\n  /** Props to apply to the overlay container element. */\n  overlayProps: HTMLAttributes<HTMLElement>;\n}\n\nconst visibleOverlays: RefObject<HTMLElement>[] = [];\n\n/**\n * Provides the behavior for overlays such as dialogs, popovers, and menus.\n * Hides the overlay when the user interacts outside it, when the Escape key is pressed,\n * or optionally, on blur. Only the top-most overlay will close at once.\n */\nexport function useOverlay(\n  props: OverlayProps,\n  ref: RefObject<HTMLElement>\n): OverlayAria {\n  let {\n    onClose,\n    shouldCloseOnBlur,\n    isOpen,\n    isKeyboardDismissDisabled = false,\n  } = props;\n\n  // Add the overlay ref to the stack of visible overlays on mount, and remove on unmount.\n  useEffect(() => {\n    if (isOpen) {\n      visibleOverlays.push(ref);\n    }\n\n    return () => {\n      let index = visibleOverlays.indexOf(ref);\n      if (index >= 0) {\n        visibleOverlays.splice(index, 1);\n      }\n    };\n  }, [isOpen, ref]);\n\n  // Only hide the overlay when it is the topmost visible overlay in the stack.\n  let onHide = () => {\n    if (visibleOverlays[visibleOverlays.length - 1] === ref && onClose) {\n      onClose();\n    }\n  };\n\n  // Handle the escape key\n  let onKeyDown = (e: any) => {\n    if (e.key === 'Escape' && !isKeyboardDismissDisabled) {\n      e.preventDefault();\n      onHide();\n    }\n  };\n\n  // Handle clicking outside the overlay to close it\n\n  let { focusWithinProps } = useFocusWithin({\n    isDisabled: !shouldCloseOnBlur,\n    onBlurWithin: () => {\n      onClose && onClose();\n    },\n  });\n\n  return {\n    overlayProps: {\n      onKeyDown,\n      ...focusWithinProps,\n    },\n  };\n}\n"]},"metadata":{},"sourceType":"module"}